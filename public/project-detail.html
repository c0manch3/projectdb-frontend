<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–ü—Ä–æ–µ–∫—Ç - LenconDB</title>
  <link rel="stylesheet" href="style.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
  <!-- Header -->
  <header class="header">
    <a href="projects.html" class="header__logo">LenconDB</a>
    
    <nav class="header__nav">
      <a href="projects.html" class="header__nav-link">–ü—Ä–æ–µ–∫—Ç—ã</a>
      <a href="employees.html" class="header__nav-link" id="employeesNav">–°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏</a>
      <a href="companies.html" class="header__nav-link">–ö–æ–º–ø–∞–Ω–∏–∏</a>
      <a href="workload.html" class="header__nav-link">–ó–∞–≥—Ä—É–∂–µ–Ω–Ω–æ—Å—Ç—å</a>
    </nav>
    
    <div class="header__user">
      <div class="header__user-info">
        <div class="header__user-name" id="userName">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
        <div class="header__user-role" id="userRole">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
      </div>
      <div class="header__user-avatar" id="userAvatar">?</div>
      <button class="button button--secondary button--small" onclick="logout()">–í—ã–π—Ç–∏</button>
    </div>
  </header>

  <!-- Main Content -->
  <main class="main">
    <div class="page-header">
      <div class="container">
        <div class="breadcrumbs">
          <a href="projects.html" class="breadcrumbs__link">–ü—Ä–æ–µ–∫—Ç—ã</a>
          <span class="breadcrumbs__separator">‚Ä∫</span>
          <span class="breadcrumbs__item" id="projectBreadcrumb">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
        </div>
        <h1 class="page-header__title" id="projectTitle">–ó–∞–≥—Ä—É–∑–∫–∞...</h1>
        <p class="page-header__subtitle" id="projectSubtitle">–ó–∞–≥—Ä—É–∑–∫–∞...</p>
      </div>
    </div>

    <div class="container">
      <!-- Project Info Card -->
      <div class="card" id="projectInfoCard">
        <div class="card__content">
          <div id="projectInfoContent">
            <p>–ó–∞–≥—Ä—É–∑–∫–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø—Ä–æ–µ–∫—Ç–µ...</p>
          </div>
        </div>
      </div>

      <!-- Tabs -->
      <div class="card" style="margin-top: 1.5rem;">
        <div class="tabs">
          <div class="tabs__list">
            <button class="tabs__button tabs__button--active" data-tab="constructions">
              –ö–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ <span id="constructionsCount" class="status-badge status-badge--pending">0</span>
            </button>
            <button class="tabs__button" data-tab="documents">
              –î–æ–∫—É–º–µ–Ω—Ç—ã <span id="documentsCount" class="status-badge status-badge--pending">0</span>
            </button>
            <button class="tabs__button" data-tab="team">
              –ö–æ–º–∞–Ω–¥–∞ <span id="teamCount" class="status-badge status-badge--pending">0</span>
            </button>
            <button class="tabs__button" data-tab="workload">
              –ó–∞–≥—Ä—É–∂–µ–Ω–Ω–æ—Å—Ç—å
            </button>
          </div>
        </div>
        
        <div class="tabs__content">
          <!-- Constructions Tab -->
          <div id="constructions-tab" class="tab-content">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
              <h3>–ö–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏</h3>
              <button class="button button--primary" id="newConstructionButton" onclick="showNewConstructionModal()">
                + –ù–æ–≤–∞—è –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—è
              </button>
            </div>
            
            <div class="table-container">
              <table class="table">
                <thead class="table__head">
                  <tr>
                    <th class="table__header">–ù–∞–∑–≤–∞–Ω–∏–µ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏</th>
                    <th class="table__header">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤</th>
                    <th class="table__header">–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è</th>
                    <th class="table__header">–î–µ–π—Å—Ç–≤–∏—è</th>
                  </tr>
                </thead>
                <tbody class="table__body" id="constructionsTableBody">
                  <!-- –ö–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∑–¥–µ—Å—å -->
                </tbody>
              </table>
            </div>
          </div>

          <!-- Documents Tab -->
          <div id="documents-tab" class="tab-content" style="display: none;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
              <h3>–î–æ–∫—É–º–µ–Ω—Ç—ã</h3>
              <button class="button button--primary" id="uploadDocumentButton" onclick="showUploadModal()">
                üì§ –ó–∞–≥—Ä—É–∑–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç
              </button>
            </div>

            <div style="display: flex; gap: 1rem; margin-bottom: 1.5rem;">
              <select id="documentTypeFilter" class="form__select" style="min-width: 200px;">
                <option value="all">–í—Å–µ —Ç–∏–ø—ã –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤</option>
                <option value="km">–ö–ú - –ö–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –º–µ—Ç–∞–ª–ª–∏—á–µ—Å–∫–∏–µ</option>
                <option value="kz">–ö–ñ - –ö–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –∂–µ–ª–µ–∑–æ–±–µ—Ç–æ–Ω–Ω—ã–µ</option>
                <option value="rpz">–†–ü–ó - –†–∞—Å—á–µ—Ç–Ω–æ-–ø–æ—è—Å–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∑–∞–ø–∏—Å–∫–∞</option>
                <option value="tz">–¢–ó - –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ</option>
                <option value="gp">–ì–ü - –ì–µ–Ω–ø–ª–∞–Ω</option>
                <option value="igi">–ò–ì–ò - –ò–Ω–∂–µ–Ω–µ—Ä–Ω–æ-–≥–µ–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–µ –∏–∑—ã—Å–∫–∞–Ω–∏—è</option>
                <option value="spozu">–°–ü–û–ó–£ - –°—Ö–µ–º–∞ –ø–ª–∞–Ω–∏—Ä–æ–≤–æ—á–Ω–æ–π –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏</option>
                <option value="contract">–î–æ–≥–æ–≤–æ—Ä</option>
              </select>
              <select id="documentContextFilter" class="form__select" style="min-width: 200px;">
                <option value="all">–í—Å–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç—ã</option>
                <option value="initial_data">–ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ</option>
                <option value="project_doc">–ü—Ä–æ–µ–∫—Ç–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è</option>
              </select>
            </div>
            
            <div class="table-container">
              <table class="table">
                <thead class="table__head">
                  <tr>
                    <th class="table__header">–ù–∞–∑–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞</th>
                    <th class="table__header">–¢–∏–ø</th>
                    <th class="table__header">–ö–æ–Ω—Ç–µ–∫—Å—Ç</th>
                    <th class="table__header">–ö–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—è</th>
                    <th class="table__header">–†–∞–∑–º–µ—Ä</th>
                    <th class="table__header">–î–∞—Ç–∞ –∑–∞–≥—Ä—É–∑–∫–∏</th>
                    <th class="table__header">–î–µ–π—Å—Ç–≤–∏—è</th>
                  </tr>
                </thead>
                <tbody class="table__body" id="documentsTableBody">
                  <!-- –î–æ–∫—É–º–µ–Ω—Ç—ã –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∑–¥–µ—Å—å -->
                </tbody>
              </table>
            </div>
          </div>

          <!-- Team Tab -->
          <div id="team-tab" class="tab-content" style="display: none;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
              <h3>–ö–æ–º–∞–Ω–¥–∞ –ø—Ä–æ–µ–∫—Ç–∞</h3>
              <button class="button button--primary" id="addTeamMemberButton" onclick="showAddTeamMemberModal()">
                + –î–æ–±–∞–≤–∏—Ç—å —É—á–∞—Å—Ç–Ω–∏–∫–∞
              </button>
            </div>
            
            <div class="table-container">
              <table class="table">
                <thead class="table__head">
                  <tr>
                    <th class="table__header">–§–ò–û</th>
                    <th class="table__header">Email</th>
                    <th class="table__header">–†–æ–ª—å</th>
                    <th class="table__header">–ö–æ–º–ø–∞–Ω–∏—è</th>
                    <th class="table__header">–î–∞—Ç–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è</th>
                    <th class="table__header">–î–µ–π—Å—Ç–≤–∏—è</th>
                  </tr>
                </thead>
                <tbody class="table__body" id="teamTableBody">
                  <!-- –£—á–∞—Å—Ç–Ω–∏–∫–∏ –∫–æ–º–∞–Ω–¥—ã –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∑–¥–µ—Å—å -->
                </tbody>
              </table>
            </div>
          </div>

          <!-- Workload Tab -->
          <div id="workload-tab" class="tab-content" style="display: none;">
            <h3 style="margin-bottom: 1.5rem;">–ó–∞–≥—Ä—É–∂–µ–Ω–Ω–æ—Å—Ç—å –ø–æ –ø—Ä–æ–µ–∫—Ç—É</h3>
            
            <div style="display: flex; gap: 1rem; margin-bottom: 1.5rem;">
              <select id="workloadPeriod" class="form__select">
                <option value="week">–¢–µ–∫—É—â–∞—è –Ω–µ–¥–µ–ª—è</option>
                <option value="month">–¢–µ–∫—É—â–∏–π –º–µ—Å—è—Ü</option>
              </select>
              <select id="workloadEmployee" class="form__select">
                <option value="all">–í—Å–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∏</option>
              </select>
            </div>

            <div class="workload-calendar" id="workloadCalendar">
              <!-- –ö–∞–ª–µ–Ω–¥–∞—Ä—å –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ—Å—Ç–∏ –±—É–¥–µ—Ç –æ—Ç—Ä–µ–Ω–¥–µ—Ä–µ–Ω –∑–¥–µ—Å—å -->
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>

  <!-- New Construction Modal -->
  <div class="modal-overlay" id="newConstructionModal">
    <div class="modal">
      <div class="modal__header">
        <h3 class="modal__title">–ù–æ–≤–∞—è –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—è</h3>
        <button class="modal__close" onclick="hideNewConstructionModal()">√ó</button>
      </div>
      <div class="modal__content">
        <form class="form" id="newConstructionForm">
          <div class="form__group">
            <label for="constructionName" class="form__label form__label--required">–ù–∞–∑–≤–∞–Ω–∏–µ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏</label>
            <input 
              type="text" 
              id="constructionName" 
              class="form__input" 
              placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –§—É–Ω–¥–∞–º–µ–Ω—Ç–Ω–∞—è –ø–ª–∏—Ç–∞ –∫–æ—Ä–ø—É—Å–∞ –ê" 
              required
            >
          </div>
        </form>
      </div>
      <div class="modal__footer">
        <button class="button button--secondary" onclick="hideNewConstructionModal()">–û—Ç–º–µ–Ω–∞</button>
        <button class="button button--primary" onclick="createConstruction()">–°–æ–∑–¥–∞—Ç—å</button>
      </div>
    </div>
  </div>

  <!-- Upload Document Modal -->
  <div class="modal-overlay" id="uploadDocumentModal">
    <div class="modal">
      <div class="modal__header">
        <h3 class="modal__title">–ó–∞–≥—Ä—É–∑–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç</h3>
        <button class="modal__close" onclick="hideUploadModal()">√ó</button>
      </div>
      <div class="modal__content">
        <form class="form" id="uploadDocumentForm">
          <div class="file-upload" id="fileUpload">
            <input type="file" id="fileInput" class="file-upload__input" accept=".pdf,.dwg,.doc,.docx,.xls,.xlsx" multiple>
            <div class="file-upload__icon">üìÑ</div>
            <div class="file-upload__text">–ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ —Ñ–∞–π–ª—ã —Å—é–¥–∞ –∏–ª–∏ –Ω–∞–∂–º–∏—Ç–µ –¥–ª—è –≤—ã–±–æ—Ä–∞</div>
            <div class="file-upload__hint">–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã: PDF, DWG, DOC, DOCX, XLS, XLSX (–¥–æ 100 –ú–ë)</div>
          </div>

          <div class="form__group">
            <label for="documentType" class="form__label form__label--required">–¢–∏–ø –¥–æ–∫—É–º–µ–Ω—Ç–∞</label>
            <select id="documentType" class="form__select" required>
              <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø</option>
              <option value="km">–ö–ú - –ö–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –º–µ—Ç–∞–ª–ª–∏—á–µ—Å–∫–∏–µ</option>
              <option value="kz">–ö–ñ - –ö–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –∂–µ–ª–µ–∑–æ–±–µ—Ç–æ–Ω–Ω—ã–µ</option>
              <option value="rpz">–†–ü–ó - –†–∞—Å—á–µ—Ç–Ω–æ-–ø–æ—è—Å–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∑–∞–ø–∏—Å–∫–∞</option>
              <option value="tz">–¢–ó - –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ</option>
              <option value="gp">–ì–ü - –ì–µ–Ω–ø–ª–∞–Ω</option>
              <option value="igi">–ò–ì–ò - –ò–Ω–∂–µ–Ω–µ—Ä–Ω–æ-–≥–µ–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–µ –∏–∑—ã—Å–∫–∞–Ω–∏—è</option>
              <option value="spozu">–°–ü–û–ó–£ - –°—Ö–µ–º–∞ –ø–ª–∞–Ω–∏—Ä–æ–≤–æ—á–Ω–æ–π –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏</option>
              <option value="contract">–î–æ–≥–æ–≤–æ—Ä</option>
            </select>
          </div>

          <div class="form__group">
            <label for="documentContext" class="form__label form__label--required">–ö–æ–Ω—Ç–µ–∫—Å—Ç –¥–æ–∫—É–º–µ–Ω—Ç–∞</label>
            <select id="documentContext" class="form__select" required>
              <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç</option>
              <option value="initial_data">–ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ</option>
              <option value="project_doc">–ü—Ä–æ–µ–∫—Ç–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è</option>
            </select>
          </div>

          <div class="form__group">
            <label for="constructionSelect" class="form__label">–ö–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)</label>
            <select id="constructionSelect" class="form__select">
              <option value="">–ù–µ –ø—Ä–∏–≤—è–∑–∞–Ω –∫ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏</option>
            </select>
          </div>

          <div class="progress-bar" id="uploadProgress" style="display: none;">
            <div class="progress-bar__fill" id="progressFill"></div>
          </div>
        </form>
      </div>
      <div class="modal__footer">
        <button class="button button--secondary" onclick="hideUploadModal()">–û—Ç–º–µ–Ω–∞</button>
        <button class="button button--primary" id="uploadButton" onclick="uploadDocuments()">–ó–∞–≥—Ä—É–∑–∏—Ç—å</button>
      </div>
    </div>
  </div>

  <!-- Add Team Member Modal -->
  <div class="modal-overlay" id="addTeamMemberModal">
    <div class="modal">
      <div class="modal__header">
        <h3 class="modal__title">–î–æ–±–∞–≤–∏—Ç—å —É—á–∞—Å—Ç–Ω–∏–∫–∞</h3>
        <button class="modal__close" onclick="hideAddTeamMemberModal()">√ó</button>
      </div>
      <div class="modal__content">
        <form class="form" id="addTeamMemberForm">
          <div class="form__group">
            <label for="employeeSelect" class="form__label form__label--required">–°–æ—Ç—Ä—É–¥–Ω–∏–∫</label>
            <select id="employeeSelect" class="form__select" required>
              <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞</option>
            </select>
          </div>
        </form>
      </div>
      <div class="modal__footer">
        <button class="button button--secondary" onclick="hideAddTeamMemberModal()">–û—Ç–º–µ–Ω–∞</button>
        <button class="button button--primary" onclick="addTeamMember()">–î–æ–±–∞–≤–∏—Ç—å</button>
      </div>
    </div>
  </div>

  <script>
    // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
    let currentUser = null;
    let currentProject = null;
    let constructions = [];
    let documents = [];
    let teamMembers = [];
    let activeTab = 'constructions';

    // –ü–æ–ª—É—á–µ–Ω–∏–µ ID –ø—Ä–æ–µ–∫—Ç–∞ –∏–∑ URL
    function getProjectIdFromUrl() {
      const urlParams = new URLSearchParams(window.location.search);
      return urlParams.get('id');
    }

    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
    function checkAuth() {
      const user = localStorage.getItem('user');
      const accessToken = localStorage.getItem('accessToken');
      
      if (!user || !accessToken) {
        window.location.href = 'login.html';
        return;
      }
      
      currentUser = JSON.parse(user);
      
      // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
      document.getElementById('userName').textContent = `${currentUser.firstName} ${currentUser.lastName}`;
      document.getElementById('userRole').textContent = getRoleText(currentUser.role);
      document.getElementById('userAvatar').textContent = `${currentUser.firstName[0]}${currentUser.lastName[0]}`;
      
      updateUIForRole();
    }

    // –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ —Ä–æ–ª–∏
    function getRoleText(role) {
      const roles = {
        'Admin': '–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä',
        'Manager': '–ú–µ–Ω–µ–¥–∂–µ—Ä',
        'Employee': '–°–æ—Ç—Ä—É–¥–Ω–∏–∫',
        'Customer': '–ó–∞–∫–∞–∑—á–∏–∫'
      };
      return roles[role] || role;
    }

    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–æ–ª–∏
    function updateUIForRole() {
      const employeesNav = document.getElementById('employeesNav');
      const newConstructionButton = document.getElementById('newConstructionButton');
      const uploadDocumentButton = document.getElementById('uploadDocumentButton');
      const addTeamMemberButton = document.getElementById('addTeamMemberButton');
      
      if (currentUser.role === 'Employee') {
        employeesNav.style.display = 'none';
        newConstructionButton.style.display = 'none';
        uploadDocumentButton.textContent = 'üëÅ –ü—Ä–æ—Å–º–æ—Ç—Ä –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤';
        uploadDocumentButton.onclick = null;
        addTeamMemberButton.style.display = 'none';
      }
    }

    // –í—ã—Ö–æ–¥ –∏–∑ —Å–∏—Å—Ç–µ–º—ã
    function logout() {
      localStorage.removeItem('user');
      localStorage.removeItem('accessToken');
      localStorage.removeItem('refreshToken');
      window.location.href = 'login.html';
    }

    // –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
    const demoProjects = [
      {
        id: '1',
        name: '–ñ–ö –°–æ–ª–Ω–µ—á–Ω—ã–π',
        type: 'main',
        customerId: '1',
        customerName: '–û–û–û "–°—Ç—Ä–æ–π–ò–Ω–≤–µ—Å—Ç"',
        managerId: '2',
        managerName: '–ï–ª–µ–Ω–∞ –ü–µ—Ç—Ä–æ–≤–∞',
        contractDate: '2024-01-15',
        expirationDate: '2024-12-31',
        cost: 25000000,
        status: 'active',
        constructions: 3,
        documents: 12
      },
      {
        id: '2',
        name: '–¢–¶ –ï–≤—Ä–æ–ø–∞',
        type: 'main',
        customerId: '2',
        customerName: '–ê–û "–¢–æ—Ä–≥–æ–≤—ã–µ —Ü–µ–Ω—Ç—Ä—ã"',
        managerId: '2',
        managerName: '–ï–ª–µ–Ω–∞ –ü–µ—Ç—Ä–æ–≤–∞',
        contractDate: '2024-02-01',
        expirationDate: '2024-08-30',
        cost: 45000000,
        status: 'overdue',
        constructions: 5,
        documents: 24
      }
    ];

    const demoConstructions = [
      {
        id: '1',
        projectId: '1',
        name: '–§—É–Ω–¥–∞–º–µ–Ω—Ç–Ω–∞—è –ø–ª–∏—Ç–∞ –∫–æ—Ä–ø—É—Å–∞ –ê',
        createdAt: '2024-02-01',
        documentsCount: 5
      },
      {
        id: '2', 
        projectId: '1',
        name: '–ù–µ—Å—É—â–∏–µ —Å—Ç–µ–Ω—ã –∫–æ—Ä–ø—É—Å–∞ –ê',
        createdAt: '2024-02-15',
        documentsCount: 3
      },
      {
        id: '3',
        projectId: '1', 
        name: '–ü–µ—Ä–µ–∫—Ä—ã—Ç–∏—è –∫–æ—Ä–ø—É—Å–∞ –ê',
        createdAt: '2024-03-01',
        documentsCount: 4
      }
    ];

    const demoDocuments = [
      {
        id: '1',
        projectId: '1',
        constructionId: '1',
        fileName: '–ö–ñ-01_–§—É–Ω–¥–∞–º–µ–Ω—Ç–Ω–∞—è_–ø–ª–∏—Ç–∞.pdf',
        originalName: '–ö–ñ-01_–§—É–Ω–¥–∞–º–µ–Ω—Ç–Ω–∞—è_–ø–ª–∏—Ç–∞.pdf',
        type: 'kz',
        context: 'project_doc',
        size: 2500000,
        uploadedAt: '2024-02-05',
        version: 1
      },
      {
        id: '2',
        projectId: '1',
        constructionId: null,
        fileName: '–¢–ó_–ñ–ö_–°–æ–ª–Ω–µ—á–Ω—ã–π.docx',
        originalName: '–¢–ó_–ñ–ö_–°–æ–ª–Ω–µ—á–Ω—ã–π.docx',
        type: 'tz',
        context: 'initial_data',
        size: 850000,
        uploadedAt: '2024-01-20',
        version: 1
      },
      {
        id: '3',
        projectId: '1',
        constructionId: '2',
        fileName: '–ö–ñ-02_–ù–µ—Å—É—â–∏–µ_—Å—Ç–µ–Ω—ã.dwg',
        originalName: '–ö–ñ-02_–ù–µ—Å—É—â–∏–µ_—Å—Ç–µ–Ω—ã.dwg',
        type: 'kz',
        context: 'project_doc',
        size: 4200000,
        uploadedAt: '2024-02-20',
        version: 1
      }
    ];

    const demoTeamMembers = [
      {
        id: '1',
        projectId: '1',
        userId: '2',
        userName: '–ï–ª–µ–Ω–∞ –ü–µ—Ç—Ä–æ–≤–∞',
        userEmail: 'manager@lencondb.com',
        userRole: 'Manager',
        companyName: '–õ–µ–Ω–∫–æ–Ω–ë—é—Ä–æ',
        addedAt: '2024-01-15'
      },
      {
        id: '2',
        projectId: '1',
        userId: '3',
        userName: '–ò–≤–∞–Ω –ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–æ–≤',
        userEmail: 'employee@lencondb.com',
        userRole: 'Employee',
        companyName: '–õ–µ–Ω–∫–æ–Ω–ë—é—Ä–æ',
        addedAt: '2024-01-20'
      }
    ];

    const demoEmployees = [
      { id: '3', name: '–ò–≤–∞–Ω –ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–æ–≤', email: 'employee@lencondb.com' },
      { id: '4', name: '–ú–∞—Ä–∏—è –ß–µ—Ä—Ç–µ–∂–Ω–∏–∫–æ–≤–∞', email: 'maria@lencondb.com' },
      { id: '5', name: '–ü–µ—Ç—Ä –ü—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤—â–∏–∫', email: 'petr@lencondb.com' }
    ];

    // –ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞
    function loadProject() {
      const projectId = getProjectIdFromUrl();
      if (!projectId) {
        window.location.href = 'projects.html';
        return;
      }

      currentProject = demoProjects.find(p => p.id === projectId);
      if (!currentProject) {
        window.location.href = 'not-found.html';
        return;
      }

      // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤
      document.getElementById('projectBreadcrumb').textContent = currentProject.name;
      document.getElementById('projectTitle').textContent = currentProject.name;
      document.getElementById('projectSubtitle').textContent = `${currentProject.customerName} ‚Ä¢ ${getStatusText(currentProject.status)}`;

      // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø—Ä–æ–µ–∫—Ç–µ
      renderProjectInfo();
      loadProjectData();
    }

    // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø—Ä–æ–µ–∫—Ç–µ
    function renderProjectInfo() {
      const infoContent = document.getElementById('projectInfoContent');
      infoContent.innerHTML = `
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1.5rem;">
          <div>
            <div style="font-size: 0.875rem; color: var(--text-secondary); margin-bottom: 0.25rem;">–ó–∞–∫–∞–∑—á–∏–∫</div>
            <div style="font-weight: 500;">${currentProject.customerName}</div>
          </div>
          <div>
            <div style="font-size: 0.875rem; color: var(--text-secondary); margin-bottom: 0.25rem;">–ú–µ–Ω–µ–¥–∂–µ—Ä</div>
            <div style="font-weight: 500;">${currentProject.managerName || '–ù–µ –Ω–∞–∑–Ω–∞—á–µ–Ω'}</div>
          </div>
          <div>
            <div style="font-size: 0.875rem; color: var(--text-secondary); margin-bottom: 0.25rem;">–î–∞—Ç–∞ –¥–æ–≥–æ–≤–æ—Ä–∞</div>
            <div style="font-weight: 500;">${formatDate(currentProject.contractDate)}</div>
          </div>
          <div>
            <div style="font-size: 0.875rem; color: var(--text-secondary); margin-bottom: 0.25rem;">–°—Ä–æ–∫ —Å–¥–∞—á–∏</div>
            <div style="font-weight: 500;">${formatDate(currentProject.expirationDate)}</div>
          </div>
          <div>
            <div style="font-size: 0.875rem; color: var(--text-secondary); margin-bottom: 0.25rem;">–°—Ç–æ–∏–º–æ—Å—Ç—å</div>
            <div style="font-weight: 500;">${formatCurrency(currentProject.cost)}</div>
          </div>
          <div>
            <div style="font-size: 0.875rem; color: var(--text-secondary); margin-bottom: 0.25rem;">–°—Ç–∞—Ç—É—Å</div>
            <span class="status-badge status-badge--${currentProject.status}">
              ${getStatusText(currentProject.status)}
            </span>
          </div>
        </div>
      `;
    }

    // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–∞
    function loadProjectData() {
      constructions = demoConstructions.filter(c => c.projectId === currentProject.id);
      documents = demoDocuments.filter(d => d.projectId === currentProject.id);
      teamMembers = demoTeamMembers.filter(t => t.projectId === currentProject.id);

      // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—á–µ—Ç—á–∏–∫–æ–≤ –≤ —Ç–∞–±–∞—Ö
      document.getElementById('constructionsCount').textContent = constructions.length;
      document.getElementById('documentsCount').textContent = documents.length;
      document.getElementById('teamCount').textContent = teamMembers.length;

      renderActiveTab();
    }

    // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ –∞–∫—Ç–∏–≤–Ω–æ–≥–æ —Ç–∞–±–∞
    function renderActiveTab() {
      switch (activeTab) {
        case 'constructions':
          renderConstructions();
          break;
        case 'documents':
          renderDocuments();
          loadConstructionsForDocumentModal();
          break;
        case 'team':
          renderTeam();
          loadEmployeesForTeamModal();
          break;
        case 'workload':
          renderWorkload();
          break;
      }
    }

    // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–π
    function renderConstructions() {
      const tbody = document.getElementById('constructionsTableBody');
      
      if (constructions.length === 0) {
        tbody.innerHTML = `
          <tr>
            <td colspan="4" class="text-center" style="padding: 2rem;">
              <p>–ö–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –Ω–µ —Å–æ–∑–¥–∞–Ω—ã</p>
              <button class="button button--primary" onclick="showNewConstructionModal()">–°–æ–∑–¥–∞—Ç—å –ø–µ—Ä–≤—É—é –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—é</button>
            </td>
          </tr>
        `;
        return;
      }

      tbody.innerHTML = constructions.map(construction => `
        <tr class="table__row">
          <td class="table__cell">
            <div style="font-weight: 500;">${construction.name}</div>
          </td>
          <td class="table__cell">${construction.documentsCount}</td>
          <td class="table__cell">${formatDate(construction.createdAt)}</td>
          <td class="table__cell table__cell--actions">
            <div class="table__actions">
              <button class="button button--small button--secondary" onclick="editConstruction('${construction.id}')">
                –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
              </button>
              ${currentUser.role !== 'Employee' ?
                `<button class="button button--small button--danger" onclick="deleteConstruction('${construction.id}')">
                  –£–¥–∞–ª–∏—Ç—å
                </button>` :
                ''
              }
            </div>
          </td>
        </tr>
      `).join('');
    }

    // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
    function renderDocuments() {
      const tbody = document.getElementById('documentsTableBody');
      
      // –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–æ–≤
      let filteredDocuments = [...documents];
      
      const typeFilter = document.getElementById('documentTypeFilter').value;
      const contextFilter = document.getElementById('documentContextFilter').value;
      
      if (typeFilter !== 'all') {
        filteredDocuments = filteredDocuments.filter(doc => doc.type === typeFilter);
      }
      
      if (contextFilter !== 'all') {
        filteredDocuments = filteredDocuments.filter(doc => doc.context === contextFilter);
      }
      
      if (filteredDocuments.length === 0) {
        tbody.innerHTML = `
          <tr>
            <td colspan="7" class="text-center" style="padding: 2rem;">
              <p>–î–æ–∫—É–º–µ–Ω—Ç—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</p>
              ${currentUser.role !== 'Employee' ?
                '<button class="button button--primary" onclick="showUploadModal()">–ó–∞–≥—Ä—É–∑–∏—Ç—å –ø–µ—Ä–≤—ã–π –¥–æ–∫—É–º–µ–Ω—Ç</button>' :
                ''
              }
            </td>
          </tr>
        `;
        return;
      }

      tbody.innerHTML = filteredDocuments.map(doc => {
        const construction = constructions.find(c => c.id === doc.constructionId);
        return `
          <tr class="table__row">
            <td class="table__cell">
              <div style="font-weight: 500;">${doc.originalName}</div>
            </td>
            <td class="table__cell">${getDocumentTypeText(doc.type)}</td>
            <td class="table__cell">${getDocumentContextText(doc.context)}</td>
            <td class="table__cell">${construction ? construction.name : '–ë–µ–∑ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏'}</td>
            <td class="table__cell">${formatFileSize(doc.size)}</td>
            <td class="table__cell">${formatDate(doc.uploadedAt)}</td>
            <td class="table__cell table__cell--actions">
              <div class="table__actions">
                <button class="button button--small button--secondary" onclick="downloadDocument('${doc.id}')">
                  üì• –°–∫–∞—á–∞—Ç—å
                </button>
                <button class="button button--small button--secondary" onclick="previewDocument('${doc.id}')">
                  üëÅ –ü—Ä–æ—Å–º–æ—Ç—Ä
                </button>
                ${currentUser.role !== 'Employee' ?
                  `<button class="button button--small button--danger" onclick="deleteDocument('${doc.id}')">
                    –£–¥–∞–ª–∏—Ç—å
                  </button>` :
                  ''
                }
              </div>
            </td>
          </tr>
        `;
      }).join('');
    }

    // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ –∫–æ–º–∞–Ω–¥—ã
    function renderTeam() {
      const tbody = document.getElementById('teamTableBody');
      
      if (teamMembers.length === 0) {
        tbody.innerHTML = `
          <tr>
            <td colspan="6" class="text-center" style="padding: 2rem;">
              <p>–£—á–∞—Å—Ç–Ω–∏–∫–∏ –Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω—ã</p>
              ${currentUser.role !== 'Employee' ?
                '<button class="button button--primary" onclick="showAddTeamMemberModal()">–î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–≤–æ–≥–æ —É—á–∞—Å—Ç–Ω–∏–∫–∞</button>' :
                ''
              }
            </td>
          </tr>
        `;
        return;
      }

      tbody.innerHTML = teamMembers.map(member => `
        <tr class="table__row">
          <td class="table__cell">
            <div style="font-weight: 500;">${member.userName}</div>
          </td>
          <td class="table__cell">${member.userEmail}</td>
          <td class="table__cell">${getRoleText(member.userRole)}</td>
          <td class="table__cell">${member.companyName}</td>
          <td class="table__cell">${formatDate(member.addedAt)}</td>
          <td class="table__cell table__cell--actions">
            <div class="table__actions">
              ${currentUser.role !== 'Employee' && member.userRole !== 'Manager' ?
                `<button class="button button--small button--danger" onclick="removeTeamMember('${member.id}')">
                  –£–¥–∞–ª–∏—Ç—å
                </button>` :
                ''
              }
            </div>
          </td>
        </tr>
      `).join('');
    }

    // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ—Å—Ç–∏
    function renderWorkload() {
      const calendar = document.getElementById('workloadCalendar');
      calendar.innerHTML = `
        <div class="text-center" style="padding: 2rem;">
          <p>–ö–∞–ª–µ–Ω–¥–∞—Ä—å –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ—Å—Ç–∏ –ø–æ –ø—Ä–æ–µ–∫—Ç—É</p>
          <p style="color: var(--text-secondary); font-size: 0.875rem;">
            –ó–¥–µ—Å—å –±—É–¥–µ—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ—Å—Ç—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –ø–æ –¥–∞–Ω–Ω–æ–º—É –ø—Ä–æ–µ–∫—Ç—É
          </p>
        </div>
      `;
    }

    // –£—Ç–∏–ª–∏—Ç—ã –¥–ª—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
    function formatDate(dateString) {
      const date = new Date(dateString);
      return date.toLocaleDateString('ru-RU');
    }

    function formatCurrency(amount) {
      return new Intl.NumberFormat('ru-RU', {
        style: 'currency',
        currency: 'RUB',
        minimumFractionDigits: 0
      }).format(amount);
    }

    function formatFileSize(bytes) {
      if (bytes === 0) return '0 –ë';
      const k = 1024;
      const sizes = ['–ë', '–ö–ë', '–ú–ë', '–ì–ë'];
      const i = Math.floor(Math.log(bytes) / Math.log(k));
      return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i];
    }

    function getStatusText(status) {
      const statuses = {
        'active': '–ê–∫—Ç–∏–≤–Ω—ã–π',
        'completed': '–ó–∞–≤–µ—Ä—à–µ–Ω',
        'overdue': '–ü—Ä–æ—Å—Ä–æ—á–µ–Ω',
        'pending': '–í –æ–∂–∏–¥–∞–Ω–∏–∏'
      };
      return statuses[status] || status;
    }

    function getDocumentTypeText(type) {
      const types = {
        'km': '–ö–ú',
        'kz': '–ö–ñ',
        'rpz': '–†–ü–ó',
        'tz': '–¢–ó',
        'gp': '–ì–ü',
        'igi': '–ò–ì–ò',
        'spozu': '–°–ü–û–ó–£',
        'contract': '–î–æ–≥–æ–≤–æ—Ä'
      };
      return types[type] || type;
    }

    function getDocumentContextText(context) {
      const contexts = {
        'initial_data': '–ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ',
        'project_doc': '–ü—Ä–æ–µ–∫—Ç–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è'
      };
      return contexts[context] || context;
    }

    // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–∞–±–∞–º–∏
    function switchTab(tabName) {
      // –°–∫—Ä—ã—Ç—å –≤—Å–µ —Ç–∞–±—ã
      document.querySelectorAll('.tab-content').forEach(tab => {
        tab.style.display = 'none';
      });
      
      // –£–±—Ä–∞—Ç—å –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —Å –∫–Ω–æ–ø–æ–∫
      document.querySelectorAll('.tabs__button').forEach(button => {
        button.classList.remove('tabs__button--active');
      });
      
      // –ü–æ–∫–∞–∑–∞—Ç—å –∞–∫—Ç–∏–≤–Ω—ã–π —Ç–∞–±
      document.getElementById(`${tabName}-tab`).style.display = 'block';
      document.querySelector(`[data-tab="${tabName}"]`).classList.add('tabs__button--active');
      
      activeTab = tabName;
      renderActiveTab();
    }

    // –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞
    function showNewConstructionModal() {
      document.getElementById('newConstructionModal').classList.add('modal-overlay--open');
    }

    function hideNewConstructionModal() {
      document.getElementById('newConstructionModal').classList.remove('modal-overlay--open');
      document.getElementById('newConstructionForm').reset();
    }

    function showUploadModal() {
      if (currentUser.role === 'Employee') return;
      document.getElementById('uploadDocumentModal').classList.add('modal-overlay--open');
    }

    function hideUploadModal() {
      document.getElementById('uploadDocumentModal').classList.remove('modal-overlay--open');
      document.getElementById('uploadDocumentForm').reset();
    }

    function showAddTeamMemberModal() {
      document.getElementById('addTeamMemberModal').classList.add('modal-overlay--open');
    }

    function hideAddTeamMemberModal() {
      document.getElementById('addTeamMemberModal').classList.remove('modal-overlay--open');
      document.getElementById('addTeamMemberForm').reset();
    }

    // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –¥–∞–Ω–Ω—ã–º–∏
    function createConstruction() {
      const form = document.getElementById('newConstructionForm');
      if (!form.checkValidity()) {
        form.reportValidity();
        return;
      }

      const newConstruction = {
        id: Date.now().toString(),
        projectId: currentProject.id,
        name: document.getElementById('constructionName').value,
        createdAt: new Date().toISOString().split('T')[0],
        documentsCount: 0
      };

      constructions.push(newConstruction);
      document.getElementById('constructionsCount').textContent = constructions.length;
      renderConstructions();
      hideNewConstructionModal();
    }

    function deleteConstruction(id) {
      if (!confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç—É –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—é?')) return;
      
      constructions = constructions.filter(c => c.id !== id);
      document.getElementById('constructionsCount').textContent = constructions.length;
      renderConstructions();
    }

    function uploadDocuments() {
      // –ò–º–∏—Ç–∞—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞
      const fileInput = document.getElementById('fileInput');
      const files = fileInput.files;
      
      if (files.length === 0) {
        alert('–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª—ã –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏');
        return;
      }
      
      const uploadButton = document.getElementById('uploadButton');
      const progressBar = document.getElementById('uploadProgress');
      const progressFill = document.getElementById('progressFill');
      
      uploadButton.disabled = true;
      uploadButton.textContent = '–ó–∞–≥—Ä—É–∑–∫–∞...';
      progressBar.style.display = 'block';
      
      let progress = 0;
      const interval = setInterval(() => {
        progress += 10;
        progressFill.style.width = `${progress}%`;
        
        if (progress >= 100) {
          clearInterval(interval);
          
          // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –≤ —Å–ø–∏—Å–æ–∫
          Array.from(files).forEach((file, index) => {
            const newDocument = {
              id: (Date.now() + index).toString(),
              projectId: currentProject.id,
              constructionId: document.getElementById('constructionSelect').value || null,
              fileName: file.name,
              originalName: file.name,
              type: document.getElementById('documentType').value,
              context: document.getElementById('documentContext').value,
              size: file.size,
              uploadedAt: new Date().toISOString().split('T')[0],
              version: 1
            };
            
            documents.push(newDocument);
          });
          
          document.getElementById('documentsCount').textContent = documents.length;
          renderDocuments();
          hideUploadModal();
          
          uploadButton.disabled = false;
          uploadButton.textContent = '–ó–∞–≥—Ä—É–∑–∏—Ç—å';
          progressBar.style.display = 'none';
          progressFill.style.width = '0%';
        }
      }, 200);
    }

    function deleteDocument(id) {
      if (!confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç?')) return;
      
      documents = documents.filter(d => d.id !== id);
      document.getElementById('documentsCount').textContent = documents.length;
      renderDocuments();
    }

    function addTeamMember() {
      const employeeId = document.getElementById('employeeSelect').value;
      if (!employeeId) return;
      
      const employee = demoEmployees.find(e => e.id === employeeId);
      if (!employee) return;
      
      // –ü—Ä–æ–≤–µ—Ä–∫–∞, —á—Ç–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫ –µ—â–µ –Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω
      if (teamMembers.find(member => member.userId === employeeId)) {
        alert('–≠—Ç–æ—Ç —Å–æ—Ç—Ä—É–¥–Ω–∏–∫ —É–∂–µ —É—á–∞—Å—Ç–≤—É–µ—Ç –≤ –ø—Ä–æ–µ–∫—Ç–µ');
        return;
      }
      
      const newTeamMember = {
        id: Date.now().toString(),
        projectId: currentProject.id,
        userId: employeeId,
        userName: employee.name,
        userEmail: employee.email,
        userRole: 'Employee',
        companyName: '–õ–µ–Ω–∫–æ–Ω–ë—é—Ä–æ',
        addedAt: new Date().toISOString().split('T')[0]
      };
      
      teamMembers.push(newTeamMember);
      document.getElementById('teamCount').textContent = teamMembers.length;
      renderTeam();
      hideAddTeamMemberModal();
    }

    function removeTeamMember(id) {
      if (!confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —É—á–∞—Å—Ç–Ω–∏–∫–∞ –∏–∑ –ø—Ä–æ–µ–∫—Ç–∞?')) return;
      
      teamMembers = teamMembers.filter(member => member.id !== id);
      document.getElementById('teamCount').textContent = teamMembers.length;
      renderTeam();
    }

    // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω
    function loadConstructionsForDocumentModal() {
      const constructionSelect = document.getElementById('constructionSelect');
      constructionSelect.innerHTML = '<option value="">–ù–µ –ø—Ä–∏–≤—è–∑–∞–Ω –∫ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏</option>';
      
      constructions.forEach(construction => {
        const option = document.createElement('option');
        option.value = construction.id;
        option.textContent = construction.name;
        constructionSelect.appendChild(option);
      });
    }

    function loadEmployeesForTeamModal() {
      const employeeSelect = document.getElementById('employeeSelect');
      employeeSelect.innerHTML = '<option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞</option>';
      
      // –§–∏–ª—å—Ç—Ä—É–µ–º —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –µ—â–µ –Ω–µ –≤ –ø—Ä–æ–µ–∫—Ç–µ
      const availableEmployees = demoEmployees.filter(employee => 
        !teamMembers.find(member => member.userId === employee.id)
      );
      
      availableEmployees.forEach(employee => {
        const option = document.createElement('option');
        option.value = employee.id;
        option.textContent = employee.name;
        employeeSelect.appendChild(option);
      });
    }

    // –§—É–Ω–∫—Ü–∏–∏ –¥–µ–π—Å—Ç–≤–∏–π —Å –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏
    function downloadDocument(id) {
      const document = documents.find(d => d.id === id);
      if (document) {
        alert(`–°–∫–∞—á–∏–≤–∞–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞: ${document.originalName}`);
      }
    }

    function previewDocument(id) {
      const document = documents.find(d => d.id === id);
      if (document) {
        alert(`–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –¥–æ–∫—É–º–µ–Ω—Ç–∞: ${document.originalName}`);
      }
    }

    function editConstruction(id) {
      const construction = constructions.find(c => c.id === id);
      if (construction) {
        const newName = prompt('–ù–æ–≤–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏:', construction.name);
        if (newName && newName.trim()) {
          construction.name = newName.trim();
          renderConstructions();
        }
      }
    }

    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
    document.addEventListener('DOMContentLoaded', () => {
      checkAuth();
      loadProject();
    });

    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è —Ç–∞–±–æ–≤
    document.querySelectorAll('.tabs__button').forEach(button => {
      button.addEventListener('click', () => {
        const tabName = button.getAttribute('data-tab');
        switchTab(tabName);
      });
    });

    // –§–∏–ª—å—Ç—Ä—ã –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
    document.getElementById('documentTypeFilter').addEventListener('change', renderDocuments);
    document.getElementById('documentContextFilter').addEventListener('change', renderDocuments);

    // Drag & Drop –¥–ª—è —Ñ–∞–π–ª–æ–≤
    const fileUpload = document.getElementById('fileUpload');
    const fileInput = document.getElementById('fileInput');

    fileUpload.addEventListener('click', () => {
      fileInput.click();
    });

    fileUpload.addEventListener('dragover', (e) => {
      e.preventDefault();
      fileUpload.classList.add('file-upload--dragover');
    });

    fileUpload.addEventListener('dragleave', () => {
      fileUpload.classList.remove('file-upload--dragover');
    });

    fileUpload.addEventListener('drop', (e) => {
      e.preventDefault();
      fileUpload.classList.remove('file-upload--dragover');
      fileInput.files = e.dataTransfer.files;
      
      if (fileInput.files.length > 0) {
        const fileText = fileUpload.querySelector('.file-upload__text');
        fileText.textContent = `–í—ã–±—Ä–∞–Ω–æ —Ñ–∞–π–ª–æ–≤: ${fileInput.files.length}`;
      }
    });

    fileInput.addEventListener('change', () => {
      if (fileInput.files.length > 0) {
        const fileText = fileUpload.querySelector('.file-upload__text');
        fileText.textContent = `–í—ã–±—Ä–∞–Ω–æ —Ñ–∞–π–ª–æ–≤: ${fileInput.files.length}`;
      }
    });

    // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω
    document.addEventListener('click', (e) => {
      if (e.target.classList.contains('modal-overlay')) {
        e.target.classList.remove('modal-overlay--open');
      }
    });

    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') {
        document.querySelectorAll('.modal-overlay--open').forEach(modal => {
          modal.classList.remove('modal-overlay--open');
        });
      }
    });
  </script>
</body>
</html>